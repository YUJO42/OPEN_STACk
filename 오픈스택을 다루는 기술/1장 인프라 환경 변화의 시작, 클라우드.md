## 1장 인프라 환경 변화의 시작, 클라우드

### 1.1 클라우드 컴퓨팅의 정의와 종류

#### 클라우드 컴퓨팅(Cloud Computing) 

- 인터넷이 가능한 디바이스로 제 3의 공간인 클라우드에서 데이터를 읽고 쓰고, 정보를 분석해 처리하며 이를 저장하고 관리하는 컴퓨팅 시스템

#### 클라우드 서비스의 종류

- **IaaS(Infrastructure as a Service) :**
  - 서버, 스토리지, 네트워크를 가상화 환경으로 만들어 필요에 따라 인프라 자원을 사용할 수 있게 하는 서비스.
  - 웹 서버나 애플리케이션 서버에서 사용할 리눅스나 윈도우 서버를 호스팅 업체에서 임대하는 것.
  - 대표적인 예 : AWS의 EC2, S3 등
- **PaaS(Platform as a Service)**
  - 웹에서 개발 플랫폼을 쉽게 빌려 쓸 수 있는 서비스
  - 미리 구축한 웹 서버나 데이터베이스 서버를 빌려 쓰는 것.
  - 네이버다 다음 등에서 제공하는 뉴스API, 케이웨더에서 제공하는 날씨API도 PaaS 서비스.
- **SaaS(Software as a Service)**
  - IaaS와 PaaS 위에 올라가는 소프트웨어를 SaaS라고 한다.
  - 중앙에서 호스팅되는 소프트웨어를 웹 브라우저 등 클라이언트로 이용하는 서비스.
  - Google docs가 대표적인 SaaS 서비스.

___

### 1.2 클라우드 핵심 서비스 컴퓨트와 스토리지

#### 컴퓨트 서비스(Compute Service)

- **컴퓨트 서비스**는 사용자가 원하는 운영체제가 탑재된 컴퓨터나 서버를 인터넷에서 사용할 수 있게 제공하는 유료 또는 무료 서비스를 말한다.

- 컴퓨트 서비스는 시스템을 구축할 때 필요한 서버를 가상으로 할당해 주는 서비스로, 이 때 할당하는 가상 서버를 **인스턴스**라고 한다.
- 필요에 따라서 개발 환경이 이미 설정된 인스턴스도 선택할 수 있다. 인스턴스는 생성과 부팅이 쉬워 요구 사항의 변화에 따라 서버 용량을 빠르게 증설하거나 축소할 수 있다.

#### 스토리지 서비스(Storage Service)

- 우리가 사용하는 구글 드라이브, N드라이브, Dropbox 등은 스토리지 서비스에 해당한다.
- 스토리지 서비스는 사용자가 소유한 데이터나 음악, 동영상, 문서 파일을 인터넷에 있는 스토리지에 저장, 삭제, 공유할 수 있는 서비스이다.
- 스토리즈 서비스는 컴퓨트 서비스와 다르게 어떤 서비스를 제공하냐에 따라 IaaS에 해당하는 서비스일 수도 있고, SaaS에 해당하는 서비스일 수도 있다.
- 구글 드라이브, N드라이브 등은 사용하기 쉽고 편리한 인터페이스를 제공하는 SaaS이다.
- 스토리지와 스토리지에 접근할 수 있는 REST API만을 제공하는 서비스를 IaaS라고 할 수 있다. 아마존의 S3나 Open Stack의 오브젝트 스토리지인 Swift 등이 IaaS서비스라고 할 수 있습니다.

---

### 1.3 하이퍼바이저의 정의와 종류

#### 하이퍼바이저(Hypervisor)

- **하이퍼바이저**는 호스트 컴퓨터(Host Computers) 한 대에서 운영체제 다수를 동시에 실행하는 논리적 플랫폼을 말한다. 가상 머신 모니터(Virtual Machine Monitor)라고도 한다.
- 하이퍼바이저는 하드웨어에 직접 설치해서 실행되는 Native(또는 베어메탈) 방식과 일반 애플리케이션처럼 프로그램으로 설치되는 Hosted 방식으로 분류한다.

#### Native (또는 베어메탈) 방식

- Native 방식의 하이퍼바이저는 해당 하드웨어에 직접 설치해서 실행됩니다. 그러면 게스트 운영체제는 이미 하드웨어에 설치된 하이퍼바이저에서 두 번째 수준으로 실행됩니다.
- 즉 하드웨어 운영체제 대신 Xen, KVM, Xen Server 같은 하이퍼바이저를 설치하고 설치된 하이퍼바이저 위에 Linux, Window등 다른 운영체제가 실행되는 방식입니다.

#### Hosted 방식

- Hosted 방식의 하이퍼바이저는 일반 프로그램처럼 호스트 운영체제에서 실행되며, 가상 머신 안에서 동작되는 게스트 운영체제는 하드웨어에서 세 번째 수준으로 실행됩니다.
- 윈도우, 리눅스, 맥 등 피시에 VirtualBox나 VMware를 설치하고 다른 운영체제를 띄우는 것을 Hosted 방식의 하이퍼바이저라고 합니다.

#### KVM

- KVM은 오픈스택의 기본 하이퍼바이저입니다. 커널을 기반으로 전가상화 방식을 지원하는 오픈 소스 하이퍼바이저 중 하나입니다. 때문에 반드시 가상화가 지원되는 Intel VT나 AMD-V가 있어야만 사용할 수 있습니다. 
- KVM을 사용하게 되면 리눅스나 윈도우 이미지를 수정하지 않고 여러 가상 머신으로 실행할 수 있습니다.

#### Xen, Xen Server

- Xen은 2003년 첫 공개 버전을 발표한 오픈 소스 하이퍼바이저입니다. 초기에는 반가상화만 지원했으나 3.0부터는 게스트 운영체제를 수정하지 않아도 Xen에서 실행이 가능해졌습니다.
- 다만 QEMU같은 CPU에뮬레이터가 아닌 전통적인 하이퍼바이저이기 때문에 호스트와 다른 아키텍처의 게스트는 실행할 수 없습니다.

#### Hyper-V

- Hyper-V는 마이크로소프트에서 윈도우 서버 2008에 추가해서 공개한 하이퍼바이저입니다.
- 디바이스 드라이버가 부모 파티션에 올라가 있어 콘솔OS의 역할을 부모 파티션이 수행합니다.
- 다른 VMware등 하이퍼바이저에 비해 크기가 훨씬 작아 오류 코드가 포함될 확률이 낮습니다.
- 가상화를 지원하는 Intel VT, AMD-V x64를 지원하는 하드웨어가 있어야 가상화가 가능합니다.

#### Docker

- Docker는 리눅스 기반의 컨테이너 런타임 오픈 소스입니다. 가상 머신과 기능이 유사하며, 가상 머신보다 훨씬 가벼운 형태로 배포가 가능합니다.
- Docker는 컨테이너(Container) 개념으로 가상 머신처럼 Docker Engine을 호스트 위에서 수행하지만, 리눅스 기반의 운영체제만 수행할 수 있습니다.

___

### 1.4 클라우드에서 알아야 할 네트워크 상식

#### 고정 IP

- 고정 IP(Fixed IP)는 회사나 집에서 사용하는 컴퓨터에 연결된 인터넷 회선에 IPtime 같은 인터넷 공유기를 연결해 고정으로 할당받는 IP를 말합니다.
- 클라우드 컴퓨트 서비스에서 생성하는 가상 인스턴스는 IP를 할당받을 때 고정 IP를 받습니다. 그러나 평소에 사용하는 컴퓨터와 다르게 우리가 설치한 클라우드 플랫폼에서 IP를 할당받습니다. 이 때 할당받은 IP는 클라우드 플랫폼에서 할당하기 때문에 인터넷은 연결되지 않습니다. 그래서 고정 IP는 가상 머신 간 내부 통신만 가능합니다.

#### 유동 IP

- 고정 IP로는 인터넷에 연결할 수 없습니다.
- 그렇기 때문에 가상 인스턴스에 인터넷 프로바이더에게서 할당받은 인터넷 IP를 할당해야 합니다. 이런 IP를 **유동 IP** 라고 합니다.
- 유동 IP는 가상 인스턴스가 외부에서 접근할 수 있도록 할당하는 인터넷이 가능한 IP입니다.
- 유동 IP는 기존에 있던 개념이 아니라 클라우드 컴퓨팅을 하면서 새로 등장한 용어입니다. 가상 인스턴스에서 인터넷이 되도록 IP를 부여했다가 필요에 따라 삭제하는 IP를 유동 IP라고 합니다.

#### IP 클래스와 IP 범위

- 클라우드 플랫폼은 많은 인스턴스를 생성하기 때문에 가상 인스턴스가 생성될 때마다 나누어 줄 IP테이블이 있습니다. 이 때 IP 테이블의 범위를 IP 범위라고 합니다. 
- IP클래스는 크게 A 클래스, B클래스, C 클래스와 다른 목적으로 예약된 D클래스, E클래스로 나눕니다.
- D클래스는 멀티캐스트용으로 예약된 클래스입니다.
- E클래스는 연구 개발을 목적으로 예약된 클래스입니다.

![](https://images.velog.io/images/yujo/post/86e67047-07e4-4353-bf60-5daec0da78e1/image.png)

- **IP 범위**는 컴퓨터에 할당할 수 있는 IP개수를 말합니다. IP는 네트워크 부분과 호스트 부분으로 나눌 수 있습니다.
- 예를 들어 203.240.100.1이라는 IP가 있고, 서브넷 마스크가 255.255.255.0이라면 203.240.100은 네트워크고, 1은 호스트 1번이라고 할 수 있습니다. 이 범위의 IP에서 할당할 수 있는 호스트 부분은 1부터 255까지가 됩니다.

#### CIDR(Classless Inter-Domain Routing)

- CIDR은 클래스가 없는 도메인 간 라우팅 기법으로 기존 IP할당 방식인 네트워크 클래스를 대체합니다. 
- IP영역을 여러 네트워킹 영역으로 나눌 때 기존 클래스 방식에 비해 다음 장점이 있습니다.
  - 급격히 부족해지는 IPv4 주소를 좀 더 효율적으로 사용할 수 있다.
  - 접두어를 이용한 주소 지정 방식의 계층적 구조를 사용해 인터넷 라우팅의 부담을 덜어 준다.
- CIDR는 기본적으로 비트 단위 IP를 체크하는 표준 분석 방식입니다. 그래서 일련의 IP들을 하나의 라우팅 테이블 항목에 넣는 것으로 라우팅을 실행합니다.

#### SDN(Software Defined Networking)

- SDN은 네트워크 제어 기능이 물리적 네트워크와 분리되도록 프로그래밍한 네트워크 구조를 말합니다.
- SDN을 특징 짓는 두 가지 포인트가 있습니다.
  1. 네트워크 제어 기능을 전달 기능과 분리해서 구현해야 한다.
  2. 네트워크 제어 기능이 개발되고 실행될 수 있는 환경을 분리해 낮은 성능의 CPU가 있는 하드웨어 스위치에 더 이상 위치시키지 않는다.
- 다시 말해 SDN이라면 네트워크 제어 기능을 기존 스위치나 라우터 등 하드웨어와 별도로 분리해야 하고, 데이터 전달 기능과도 분리해서 개발 및 실행될 수 있는 네트워크 구조여야 한다는 것입니다.

#### 오픈플로(OpenFlow)

- 오픈플로는 SDN의 근간이 되는 기술로 오픈스택 폴섬(Folsom) 버전부터 네트워크 프로젝트인 Quantum에 포함된 기술입니다. 하바나(Havana)로 오면서 네트워크 프로젝트 이름이 Neutron으로 변경되었지만 계속 오픈플로 기술을 지원합니다.
- 오픈플로는 SDN 아키텍처의 컨트롤 레이어(Control Layer)와 인프라스트럭처 레이어(Infrastructure Layer) 사이에 정의된 최초의 표준 통신 인터페이스입니다. 
- 오픈플로는 오픈플로 컨트롤러와 오픈플로 지원 네트워크 장비(라우터, 스위치) 사이에서 커뮤니케이션 역할을 담당한다고 보면 됩니다.
- 일반적인 하드웨어 기반의 네트워크 장비(라우터, 스위치)는 플로 테이블(Flow Table)을 이용해서 네트워크 트래픽을 처리하는 반면에, 오픈플로는 소프트웨어 컨트롤러로 플로 테이블을 조작하고 데이터 경로를 설정해서 사용자, 애플리케이션, 세션 계층 수준에서 실시간 변화에 대응할 수 있습니다.

#### 라우터(Router)

- 라우터는 인터넷 등 서로 다른 네트워크를 연결할 때 사용하는 장비입니다. 좀 더 전문적인 말로 표현하면 지능이 있는 경로 배정기라고 할 수 있습니다.
- 라우터는 두 가지 일을 처리하는데, 하나는 경로 결정(Path Determination)이고 다른 하나는 스위칭(Switching)입니다. 경로 결정은 데이터 패킷이 목적지까지 갈 수 있는 경로를 검사해서 어느 곳으로 가는 것이 가장 적절한지 결정하는 것입니다. 경로가 결정되면 결정된 길로 데이터 패킷을 스위칭합니다.

#### 허브(Hub)

- 인터넷이 등장하기 이전 컴퓨터와 컴퓨터를 연결해 네트워크를 구성하는 데 사용하던 장비가 바로 허브(Hub)였습니다. 허브는 UTP 랜 케이블을 사용해서 가까운 거리에 있는 컴퓨터들을 연결해 주는 네트워크 장비입니다. 
- 일반적인 UTP 랜 케이블은 케이블 길이가 100M를 넘으면 신호 감쇠 현상이 발생하는데, 이때 허브는 감쇠된 신호를 증폭하는 역할도 합니다. 그래서 컴퓨터 간 거리가 100M를 넘을 때 중간에 허브 하나를 설치하면 네트워크 연결이 가능합니다.
- 이런 이유로 허브는 멀티포트(Multiport) 리피터(Repeater)라고도 할 수 있습니다. 컴퓨터 여러 대나 네트워크를 연결하려면 당연히 포트 개수가 많아야 합니다. 그리고 들어오는 데이터를 그대로 재전송하기 때문에 리피터 역할도 하는 것입니다.

#### 브리지(Bridge)

- 브리지는 콜리전 도메인을 나누어 서로 통신이 가능하도록 다리처럼 연결해 주는 네트워크 장비입니다.
- 브리지를 사용하면 하나의 네트워크 망에 물려 있는 콜리전 도메인을 서로 다른 콜리전 도메인으로 분리합니다. 이때 분리된 콜리전 도메인을 세그먼트라고 하며, 세그먼트 E0에서 세그먼트 E1로 통신할 때는 중앙에 위치한 브리지가 서로 통신이 가능하도록 도와줍니다. 서로 다른 세그먼트가 아닌 같은 세그먼트 안의 컴퓨터끼리 통신할 때는 다른 세그먼트로 데이터가 전송되는 것을 막는 역할도 합니다.
- 한 네트워크 안에 많은 컴퓨터와 네트워크가 연결되어 있다면 CSMA/CD에 따라 충돌이 자주 발생하는데, 브리지를 사용해 네트워크를 분리하면 충돌을 많이 줄일 수 있습니다.

#### 스위치(Switch)

- 스위치는 브리지와 역할이 동일하지만 하드웨어적으로 처리하는 스위치가 소프트웨어적으로 처리하는 브리지보다 속도가 더 빠릅니다.
- 또한 스위치는 브리지보다 많은 포트 개수를 제공합니다. 브리지가 포트 2~3개를 제공한다면 스위치는 포트를 20~100개 이상 제공합니다.
- 브리지는 Store-and-forward라는 프레임 처리 방식만 지원하지만, 스위치는 Cut-through, Store-and-forward라는 프레임 처리 방식을 지원합니다.

___

### 1.5 블록 스토리지와 오브젝트 스토리지의 차이

#### 블록 스토리지(Block Storage)

- 클라우드 컴퓨트 서비스에서 할당받은 인스턴스도 물리 컴퓨터와 마찬가지로 하드 디스크를 추가할 수 있습니다. 클라우드 컴퓨팅에서 컴퓨터나 서버를 "인스턴스"라고 하는 것처럼 인스턴스에 추가하는 하드 디스크를 **"블록 스토리지"**라고 합니다.
- 블록 스토리지는 운영체제가 설치된 인스턴스에 추가로 확장해 사용할 수 있는 디스크로, 데이터나 파일 등을 보관하려는 목적의 저장 공간입니다.
- 그래서 컴퓨터의 로컬 하드 디스크를 본체에서 분리해 다른 컴퓨터에 연결해서 사용할 수 있는 것처럼, 인스턴스의 블록 스토리지도 원래 있던 인스턴스에서 연결 해제(Detach)한 후 다른 인스턴스에 연결(Attach)해서 사용할 수 있습니다.

#### 오브젝트 스토리지(Object Storage)

- 오브젝트 스토리지는 블록 스토리지와 다르게 단독으로 구성할 수 있으며, 사용자 계정의 컨테이너에 파일이나 데이터를 저장할 수 있는 저장 공간입니다.
- 사용자별로 저장 공간을 나누는 스토리지 시스템을 구축할 때는 오브젝트 스토리지를 사용해야 합니다. 오브젝트 스토리지는 사용자 계정이 있으며, 사용자는 시스템에 로그인해야 스토리지를 사용할 수 있습니다. 파일을 저장할 수 있는 컨테이너를 생성하거나 삭제할 수 있고, 해당 컨테이너에 데이터나 음악, 동영상, 문서 파일을 올리고 내려받을 수 있습니다. 또 데이터가 필요 없을 때는 삭제도 가능합니다.
- 네이버의 N드라이브, Dropbox 같은 스토리지 서비스는 오브젝트 스토리지 서비스라고 할 수 있다.

___

